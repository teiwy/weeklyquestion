<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Question of the Week — Elegant</title>
  <link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,400&display=swap" rel="stylesheet">
  <style>
    html, body {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      background: #fff;
      color: #23253b;
      font-family: 'Playfair Display', Georgia, 'Times New Roman', Times, serif;
    }
    .container {
      margin: 0 auto;
      max-width: 600px;
      padding: 42px 15px 80px 15px;
      min-height: 100vh;
    }
    .question-block {
      text-align: center;
      margin: 0 0 44px 0;
    }
    .question-block h1 {
      font-size: 2.35rem;
      font-weight: 700;
      color: #1a2757;
      margin-bottom: 1.1em;
      line-height: 1.2;
      letter-spacing: 0.5px;
    }
    #edit-question-btn, #host-login-btn {
      background: #fff;
      border: 1.5px solid #1a2757;
      border-radius: 30px;
      cursor: pointer;
      padding: 8px 27px;
      margin-top: 6px;
      margin-bottom: 10px;
      font-family: 'Playfair Display', Georgia, serif;
      font-size: 1.16rem;
      color: #1a2757;
      font-weight: 600;
      transition: background 0.18s, color 0.18s;
      box-shadow: 0 2px 18px #2d395f09;
    }
    #edit-question-btn:hover, #host-login-btn:hover {
      background: #1a2757;
      color: #fff;
    }
    #edit-question-btn[hidden], #host-login-btn[hidden] {
      display: none !important;
    }
    .answer {
      margin-bottom: 2.2rem;
      padding: 18px 24px 13px 24px;
      border-radius: 16px;
      background: #f5f7fc;
      box-shadow: 0 3px 18px #e9ebf29a;
      font-size: 1.14rem;
      border: 1.5px solid #dbe5fa;
    }
    .answer-text {
      font-size: 1.23rem;
      margin-bottom: 10px;
      color: #1a2757;
      line-height: 1.54;
      font-family: inherit;
      font-weight: 500;
    }
    .reply-btn {
      font-size: 1rem;
      margin-top: 7px;
      color: #fff;
      background: #1a2757;
      border: none;
      border-radius: 30px;
      cursor: pointer;
      padding: 5px 23px;
      font-family: inherit;
      font-weight: 400;
      letter-spacing: 0.1px;
      box-shadow: 1px 1px 12px #bdc7f823;
      transition: background 0.17s;
    }
    .reply-btn:hover {
      background: #445398;
    }
    .comments {
      margin-left: 44px;
      margin-top: 10px;
    }
    .comment {
      background: #fdfcf5;
      margin-top: 9px;
      padding: 10px 18px;
      border-radius: 8px;
      font-size: 1.08rem;
      color: #594c35;
      font-family: inherit;
      border: 1.2px solid #ede7da;
      box-shadow: 0 0 5px #ecebe88f;
    }
    .send-bar {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100vw;
      background: #fff;
      box-shadow: 0 -2px 24px #44539815;
      padding: 17px 10px 25px 10px;
      z-index: 10;
      text-align: center;
      border-top: 1.5px solid #e6eaff;
    }
    #submit-answer-form {
      display: flex;
      gap: 10px;
      align-items: center;
      font-family: inherit;
      width: 100%;
      max-width: 480px;
      margin: 0 auto;
    }
    #answer-input {
      flex: 1;
      padding: 1.1em;
      background: #f7faff;
      border: 1.5px solid #d4d8e8;
      border-radius: 30px;
      color: #23253b;
      font-size: 1.11rem;
      font-family: inherit;
      min-width: 0;
      outline: none;
      transition: border 0.18s;
    }
    #answer-input:focus { border: 1.5px solid #1a2757; }
    #submit-answer-form button {
      padding: 0 26px;
      background: #1a2757;
      border-radius: 30px;
      border: none;
      color: #fff;
      font-weight: 600;
      cursor: pointer;
      font-family: inherit;
      height: 41px;
      font-size: 1.1rem;
      box-shadow: 0 2px 16px #1a27572c;
      outline: none;
      transition: background 0.14s;
    }
    #submit-answer-form button:hover { background: #445398;}
    #timer {
      display: block;
      margin: 13px 0 0 0;
      font-family: inherit;
      color: #807661;
      font-size: 1.08rem;
      letter-spacing: 2px;
      text-align: center;
      font-weight: 500;
    }
    @media (max-width: 700px) {
      .container { max-width: 99vw; }
      .answer { font-size: 1rem;}
      .question-block h1 { font-size: 1.1rem;}
      #submit-answer-form button { padding: 0 11px;}
    }
  </style>
  <!-- Firebase scripts -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>
  <main class="container">
    <div class="question-block">
      <h1 id="main-question">What is the most interesting question to discuss this week?</h1>
      <button id="host-login-btn">Host Login</button>
      <button id="edit-question-btn" hidden>✏️ Edit Question</button>
    </div>
    <section id="answers-section"></section>
  </main>
  <div class="send-bar">
    <form id="submit-answer-form" autocomplete="off">
      <input type="text" placeholder="Type your answer…" id="answer-input" maxlength="250" required />
      <button type="submit">Submit</button>
    </form>
    <span id="timer">Reset in: <span id="timer-value">—</span></span>
  </div>
  <template id="answer-template">
    <div class="answer">
      <div class="answer-text"></div>
      <button class="reply-btn">Reply</button>
      <div class="comments"></div>
    </div>
  </template>
  <template id="comment-template">
    <div class="comment"></div>
  </template>
  <script>
    // Firebase initialization
    const firebaseConfig = {
      apiKey: "AIzaSyAMbPj6vJmCSTUp-2wjPvu69GphSMy7SxI",
      authDomain: "sait-f1ee0.firebaseapp.com",
      databaseURL: "https://sait-f1ee0-default-rtdb.firebaseio.com",
      projectId: "sait-f1ee0",
      storageBucket: "sait-f1ee0.firebasestorage.app",
      messagingSenderId: "467609778471",
      appId: "1:467609778471:web:d25c1e8da88ce5d4fc1102",
      measurementId: "G-P2KXPPEF3S"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let answers = [];
    let currentQuestion = "What is the most interesting question to discuss this week?";
    let hostMode = false;

   db.ref('answers').on('value', snap => {
  answers = snap.val() || [];
  renderAnswers();
});


    db.ref('question').on('value', snap => {
      currentQuestion = snap.val() || currentQuestion;
      renderQuestion();
    });

    function saveAnswers() {
      db.ref('answers').set(answers);
    }
    function saveQuestion() {
      db.ref('question').set(currentQuestion);
    }

    function renderQuestion() {
      document.getElementById('main-question').textContent = currentQuestion;
      document.getElementById('edit-question-btn').hidden = !hostMode;
      document.getElementById('host-login-btn').hidden = hostMode;
    }
 function renderAnswers() {
  const sect = document.getElementById('answers-section');
  sect.innerHTML = '';
  answers.forEach((ans, idx) => {
    const tpl = document.getElementById('answer-template').content.cloneNode(true);
    tpl.querySelector('.answer-text').textContent = ans.text;
    // комментарии и остальное...
    sect.appendChild(tpl);
  });
}

        tpl.querySelector('.answer-text').textContent = ans.text;
        tpl.querySelector('.reply-btn').onclick = () => startReply(idx);
        const commDiv = tpl.querySelector('.comments');
        ans.comments.forEach(comm=>{
          const ct = document.getElementById('comment-template').content.cloneNode(true);
          ct.querySelector('.comment').textContent = comm;
          commDiv.appendChild(ct);
        });
        sect.appendChild(tpl);
      });
    }
    function startReply(answerIdx) {
      const comment = prompt("Your reply:");
      if (comment && comment.trim().length>0) {
        if (!answers[answerIdx].comments) answers[answerIdx].comments = [];
        answers[answerIdx].comments.push(comment.trim());
        saveAnswers();
      }
    }
    document.getElementById('submit-answer-form').onsubmit = e => {
      e.preventDefault();
      const val = document.getElementById('answer-input').value.trim();
      if (val.length>0) {
        answers.push({text:val, comments:[]});
        saveAnswers();
        document.getElementById('answer-input').value="";
      }
    };
    document.getElementById('edit-question-btn').onclick = ()=>{
      const val = prompt("Enter a new question for the week:");
      if (val && val.trim().length>0){
        currentQuestion = val.trim();
        saveQuestion();
      }
    };
    document.getElementById('host-login-btn').onclick = ()=>{
      const pw = prompt("Enter host password:");
      if (pw === 'Elegant2025'){
        hostMode = true;
        renderQuestion();
      } else {
        alert('Wrong password!');
      }
    };
    function updateTimer() {
      const now = new Date();
      const resetTime = new Date(now);
      resetTime.setUTCHours(0,0,0,0);
      if (now.getUTCHours() >= 0 && now.getUTCMinutes() >= 0) resetTime.setUTCDate(now.getUTCDate()+1);
      const diff = resetTime-now;
      const hours = Math.floor(diff/1000/60/60);
      const mins = Math.floor((diff/1000/60)%60);
      const secs = Math.floor((diff/1000)%60);
      document.getElementById('timer-value').textContent =
        `${hours}h ${mins}m ${secs}s`;
      if (diff<1000) resetAnswers();
    }
    setInterval(updateTimer, 1000);
    function resetAnswers() {
      answers=[];
      saveAnswers();
    }
  </script>
</body>
</html>


